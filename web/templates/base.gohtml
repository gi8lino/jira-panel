{{ define "base" }}
<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="refresh-interval" content="{{ .RefreshInterval }}" />
    <meta name="config-hash" content="{{ .ConfigHash }}" />

    <link rel="preload" href="{{ .SiteRoot }}/static/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript> <link rel="stylesheet" href="{{ .SiteRoot }}/static/css/bootstrap.min.css"> </noscript>

    <title>{{ .Title }}</title>

    <style>
      {{ template "css_page" . }}
      {{ template "css_debug" . }}
    </style>

    <script>
      // Map of tile IDs to their latest hash (for JS refresh loop)
      const tileHashes = {
        {{- range $i, $tile := .Cells }}
        "{{ $i }}": "{{ $tile.Hash }}",
        {{- end }}
      };
    </script>
  </head>
  <body>
    <h1>{{ .Title }}</h1>

    <div class="grid">
      {{ range $i, $tile := .Cells }}
        <div
          class="card"
          id="tile-{{ $i }}"
          style="
            grid-column: {{ $tile.Position.Col }} / span {{ or $tile.Position.ColSpan 1 }};
            grid-row: {{ $tile.Position.Row }};
          "
          data-tile-id="{{ $i }}"
          data-row="{{ $tile.Position.Row }}"
          data-col="{{ $tile.Position.Col }}"
          data-col-span="{{ or $tile.Position.ColSpan 1 }}"
          data-template="{{ $tile.Template }}"
        >
          <div class="text-center p-4">
            <div class="spinner-border" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      {{ end }}
    </div>

    {{ template "footer" . }}
  </body>
</html>
{{ end }}

